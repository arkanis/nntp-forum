<VirtualHost *:80>
	ServerName	days.mi.hdm-stuttgart.de
	DocumentRoot	/srv/sites/days.mi.hdm-stuttgart.de/public
	
	LogLevel	warn
	ErrorLog	/srv/sites/days.mi.hdm-stuttgart.de/logs/site-error.log
	CustomLog	/srv/sites/days.mi.hdm-stuttgart.de/logs/site-access.log combined
	
	# Disable PHP magic quotes, we do the magic by ourselfs...
	php_flag	magic_quotes_gpc	Off
	php_flag	display_errors	On
	
	RewriteEngine	on
	
	RewriteRule	^/offiziell.xml$	/newsfeed.php	[last]
	
	# /  →  /forums.php
	RewriteRule	^/$	/forums.php	[last]
	
	# /hdm.mi.allgemein  →  /topics.php?newsgroup=hdm.mi.allgemein
	RewriteRule	^/([^/]+)$	/topics.php?newsgroup=$1	[last,qsappend]
	
	# /hdm.mi.allgemein/1234  →  /posts.php?newsgroup=hdm.mi.allgemein&topic=1234
	RewriteRule	^/([^/]+)/(\d+)$	/posts.php?newsgroup=$1&topic=$2	[last,qsappend]
	
	<Directory /srv/sites/days.mi.hdm-stuttgart.de/public>
		# Accept either host authentication or HTTP authentication and
		# set host authentication to deny by default (it's only used to
		# clear access to show actions later on without a login).
		Satisfy	Any
		Order	Allow,Deny
		Deny from all
		
		# Protect all application actions with a login by default
		AuthType	Basic
		AuthName	"Bitte melde dich mit deinem HdM-Account an um die Newsgroups zu lesen."
		AuthBasicProvider	ldap
		AuthLDAPURL	ldap://ldap2.mi.hdm-stuttgart.de:389/ou=userlist,dc=hdm-stuttgart,dc=de?uid?sub?(objectClass=*)
		Require	valid-user
	</Directory>
</VirtualHost>